<!DOCTYPE html>
<html lang="fr" 
	xmlns:th= "http://www.thymeleaf.org" 
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">


    <head th:replace="~{fragments/fragment-head :: head(#{error.title})}"></head>
    
    <body>
        <div id="layoutError">
            <div id="layoutError_content">
                <main>
                    <div class="container">
                        <div class="row justify-content-center">
                            <div class="col-lg-8">
                                <div class="text-center mt-4">
                                    <h1 class="display-1" th:text="${status} ?: '500'">500</h1>
                                    <p class="lead" th:text="${httpStatusLabel} ?: 'HTTP 500'">Internal Server Error</p>
                                    <p th:text="#{global.errorRaised}">Une erreur est survenue</p>
                                    
                                    <div th:if="${showStacktrace}">
                                    <!-- Affichage du message d'erreur et traces si feature flag activé -->
                                        <!-- Affichage du message d'erreur si disponible -->
                                        <div th:if="${errorMessage}" class="alert alert-danger mt-4" role="alert">
                                            <h5>Message d'erreur:</h5>
                                            <code th:text="${errorMessage}">Error message</code>
                                        </div>
                                        
                                        <!-- Affichage de la stack trace si disponible -->
                                        <div th:if="${exception}" class="alert alert-warning mt-4" role="alert">
                                            <h5>Stack Trace:</h5>
                                            <pre style="text-align: left; max-height: 400px; overflow-y: auto; background: #f5f5f5; padding: 10px; border-radius: 4px;" th:text="${exception}"></pre>
                                        </div>
                                        
                                        <!-- Affichage de la trace complète si disponible (depuis Spring Boot) -->
                                        <div th:if="${trace}" class="alert alert-secondary mt-4" role="alert">
                                            <h5>Trace complète:</h5>
                                            <pre style="text-align: left; max-height: 400px; overflow-y: auto; background: #f5f5f5; padding: 10px; border-radius: 4px; font-size: 11px;" th:text="${trace}"></pre>
                                        </div>
                                    </div>
                                    
                                    <a th:href="@{/mvc/dashboard}">
                                        <i class="fas fa-arrow-left me-1"></i>
                                        <div th:text="#{global.backToApp}">back</div>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
           <div th:insert="~{fragments/fragment-footer :: footer}"></div> 
        </div>
        <div th:insert="~{fragments/fragment-jslibs :: loginPage}"></div>
        <script th:src="@{/mvc/static/js/scripts.js}"></script>
    </body>
</html>