<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head th:insert="~{fragments/fragment-head :: head}"></head>

<body class="sb-nav-fixed">
	<div th:insert="~{fragments/fragment-navUp :: navUp}"></div>
	<div id="layoutSidenav">
		<div th:insert="~{fragments/fragment-navLeft :: navLeft}"></div>

		<div id="layoutSidenav_content">
			<main>

				<div class="container-fluid">
					<!-- Header Section -->
					<div class="row mb-4 mt-4">
						<div class="col-12">
							<div class="d-flex justify-content-between align-items-center">
								<div>
									<h1 class="mb-1" th:text="#{communautecommune.title}">title</h1>
									<p class="text-muted mb-0">Gestion des communautés de communes</p>
								</div>
								<div class="text-end">
									<a th:href="@{/mvc/management/comm2co/add}" class="btn btn-primary btn-sm">
										<i class="fas fa-plus me-2"></i><span th:text="#{communautecommune.add}"></span>
									</a>
								</div>
							</div>
						</div>
					</div>

					<!-- Filters Section (only for admin) -->
					<div class="row mb-4" th:if="${isAdmin}">
						<div class="col-12">
							<div class="card border-0 shadow-sm">
								<div class="card-body">
									<div class="row g-3">
										<!-- Region Filter -->
										<div class="col-md-4">
											<div class="d-flex align-items-center h-100">
												<form method="get" th:action="@{/mvc/management/comm2co/list}" onchange="submit();" class="w-100">
													<div class="form-floating">
														<select class="form-select" id="regionFilter" name="regionId" onchange="filterByRegion()">
															<option value="" th:selected="${selectedRegionId == null}" disabled selected>Choisir une région</option>
															<option th:each="region : ${regions}" 
																	th:value="${region.id}" 
																	th:text="${region.name}"
																	th:selected="${selectedRegionId != null && selectedRegionId == region.id}"></option>
														</select>
														<label for="regionFilter"><i class="fas fa-map me-2"></i><span>Région</span></label>
													</div>
												</form>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

					<!-- Table Section -->
					<div class="row">
						<div class="col-12">
							<div class="card border-0 shadow-sm">
								<div class="card-header bg-gradient text-white py-3">
									<h5 class="mb-0"><i class="fas fa-list-ul me-2"></i><span th:text="#{communautecommune.table.title}">Communautés</span></h5>
								</div>
								<div class="card-body p-0">
									<div class="table-responsive">
										<table class="table table-hover mb-0" id="datatablesSimple">
											<thead class="table-light">
												<tr>
													<th class="text-nowrap"><i class="fas fa-building me-1 text-muted"></i><span th:text="#{communautecommune.table.name}" /></th>
													<th class="text-nowrap"><i class="fas fa-map me-1 text-muted"></i><span th:text="#{communautecommune.table.region}" /></th>
													<th class="text-center text-nowrap"><i class="fas fa-link me-1 text-muted"></i><span th:text="#{communautecommune.table.link}" /></th>
												</tr>
											</thead>
											<tbody>
												<tr th:each="comm2co : ${listCommunauteCommune}" class="align-middle">
													<td>
														<strong th:text="${comm2co.name}" />
													</td>
													<td>
														<span class="badge bg-light text-dark" th:text="${comm2co.region != null ? comm2co.region.name : '—'}"></span>
													</td>
													<td class="text-center">
														<div class="btn-group btn-group-sm" role="group">
															<a th:href="@{/mvc/management/comm2co/edit?id={idComm2co}(idComm2co=${comm2co.id})}" class="btn btn-sm btn-outline-primary" th:title="#{communautecommune.table.link}" title="Éditer"><i class="fas fa-edit"></i></a>
														</div>
													</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

							
			</main>
		</div> <!-- layoutSidenav_content -->
	</div> <!-- layoutSidenav -->
	

	<div th:insert="~{fragments/fragment-footer :: footer}"></div>

     <div th:insert="~{fragments/fragment-jslibs :: appPage}"></div>

	<style>
		/* Custom styles for enhanced design */
		.bg-gradient {
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
		}
		
		.card {
			transition: all 0.3s ease;
		}
		
		.card:hover {
			box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.1) !important;
		}
		
		.table-hover tbody tr:hover {
			background-color: rgba(102, 126, 234, 0.05);
		}
		
		.form-label {
			font-weight: 600;
			color: #495057;
		}
		
		.form-floating > label {
			color: #6c757d;
		}
		
		.btn-group-sm .btn {
			padding: 0.25rem 0.5rem;
			font-size: 0.85rem;
		}
		
		.badge {
			font-weight: 500;
			padding: 0.4rem 0.6rem;
		}
		
		/* Smooth transitions for form elements */
		.form-select, .form-control {
			transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
		}
		
		.form-select:focus, .form-control:focus {
			border-color: #667eea;
			box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
		}
		
		/* Header styling */
		h1 {
			color: #2c3e50;
			font-weight: 700;
		}
		
		/* Table styling improvements */
		.table-light th {
			border-bottom: 2px solid #dee2e6;
			font-weight: 600;
			color: #495057;
		}
		
		.text-muted.small {
			font-size: 0.85rem;
		}
	</style>

	        }
	    });
	    
	    function filterByRegion() {
	        const regionId = document.getElementById('regionFilter').value;
	        if (regionId) {
	            window.location.href = [[@{/mvc/management/comm2co/list}]] + '?regionId=' + regionId;
	        } else {
	            window.location.href = [[@{/mvc/management/comm2co/list}]];
	        }
	    }
    </script>

</body>
</html>
