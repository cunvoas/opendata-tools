

CREATE TABLE public.iris_data (
    annee integer NOT NULL,
    iris character varying(9) NOT NULL,
    f15p numeric(16,4),
    f15p_cs1 numeric(16,4),
    f15p_cs2 numeric(16,4),
    f15p_cs3 numeric(16,4),
    f15p_cs4 numeric(16,4),
    f15p_cs5 numeric(16,4),
    f15p_cs6 numeric(16,4),
    f15p_cs7 numeric(16,4),
    f15p_cs8 numeric(16,4),
    h15p numeric(16,4),
    h15p_cs1 numeric(16,4),
    h15p_cs2 numeric(16,4),
    h15p_cs3 numeric(16,4),
    h15p_cs4 numeric(16,4),
    h15p_cs5 numeric(16,4),
    h15p_cs6 numeric(16,4),
    h15p_cs7 numeric(16,4),
    h15p_cs8 numeric(16,4),
    pop15p numeric(16,4),
    pop15p_cs1 numeric(16,4),
    pop15p_cs2 numeric(16,4),
    pop15p_cs3 numeric(16,4),
    pop15p_cs4 numeric(16,4),
    pop15p_cs5 numeric(16,4),
    pop15p_cs6 numeric(16,4),
    pop15p_cs7 numeric(16,4),
    pop15p_cs8 numeric(16,4),
    com character varying(5),
    lab_iris character varying(1),
    f0014 numeric(16,4),
    f0019 numeric(16,4),
    f1529 numeric(16,4),
    f2064 numeric(16,4),
    f3044 numeric(16,4),
    f4559 numeric(16,4),
    f6074 numeric(16,4),
    f65p numeric(16,4),
    f75p numeric(16,4),
    h0014 numeric(16,4),
    h0019 numeric(16,4),
    h1529 numeric(16,4),
    h2064 numeric(16,4),
    h3044 numeric(16,4),
    h4559 numeric(16,4),
    h6074 numeric(16,4),
    h65p numeric(16,4),
    h75p numeric(16,4),
    phormen numeric(16,4),
    pmen numeric(16,4),
    pop numeric(16,4),
    pop0002 numeric(16,4),
    pop0014 numeric(16,4),
    pop0019 numeric(16,4),
    pop0305 numeric(16,4),
    pop0610 numeric(16,4),
    pop1117 numeric(16,4),
    pop1529 numeric(16,4),
    pop1824 numeric(16,4),
    pop2064 numeric(16,4),
    pop2539 numeric(16,4),
    pop3044 numeric(16,4),
    pop4054 numeric(16,4),
    pop4559 numeric(16,4),
    pop5564 numeric(16,4),
    pop6074 numeric(16,4),
    pop6579 numeric(16,4),
    pop65p numeric(16,4),
    pop75p numeric(16,4),
    pop80p numeric(16,4),
    pop_etr numeric(16,4),
    pop_fr numeric(16,4),
    pop_imm numeric(16,4),
    popf numeric(16,4),
    poph numeric(16,4),
    typ_iris character varying(1),
    
    PRIMARY KEY (annee, iris)
) PARTITION BY LIST (annee);

CREATE TABLE iris_data_2020 PARTITION OF iris_data FOR VALUES IN (2020);



INSERT INTO public.iris_data(
    annee, iris, f15p, f15p_cs1, f15p_cs2, f15p_cs3, f15p_cs4, f15p_cs5, f15p_cs6, f15p_cs7, f15p_cs8, h15p, h15p_cs1, h15p_cs2, h15p_cs3, h15p_cs4, h15p_cs5, h15p_cs6, h15p_cs7, h15p_cs8, pop15p, pop15p_cs1, pop15p_cs2, pop15p_cs3, pop15p_cs4, pop15p_cs5, pop15p_cs6, pop15p_cs7, pop15p_cs8, com, lab_iris, f0014, f0019, f1529, f2064, f3044, f4559, f6074, f65p, f75p, h0014, h0019, h1529, h2064, h3044, h4559, h6074, h65p, h75p, phormen, pmen, pop, pop0002, pop0014, pop0019, pop0305, pop0610, pop1117, pop1529, pop1824, pop2064, pop2539, pop3044, pop4054, pop4559, pop5564, pop6074, pop6579, pop65p, pop75p, pop80p, pop_etr, pop_fr, pop_imm, popf, poph, typ_iris)
SELECT annee, iris, c20_f15p, c20_f15p_cs1, c20_f15p_cs2, c20_f15p_cs3, c20_f15p_cs4, c20_f15p_cs5, c20_f15p_cs6, c20_f15p_cs7, c20_f15p_cs8, c20_h15p, c20_h15p_cs1, c20_h15p_cs2, c20_h15p_cs3, c20_h15p_cs4, c20_h15p_cs5, c20_h15p_cs6, c20_h15p_cs7, c20_h15p_cs8, c20_pop15p, c20_pop15p_cs1, c20_pop15p_cs2, c20_pop15p_cs3, c20_pop15p_cs4, c20_pop15p_cs5, c20_pop15p_cs6, c20_pop15p_cs7, c20_pop15p_cs8, com, lab_iris, p20_f0014, p20_f0019, p20_f1529, p20_f2064, p20_f3044, p20_f4559, p20_f6074, p20_f65p, p20_f75p, p20_h0014, p20_h0019, p20_h1529, p20_h2064, p20_h3044, p20_h4559, p20_h6074, p20_h65p, p20_h75p, p20_phormen, p20_pmen, p20_pop, p20_pop0002, p20_pop0014, p20_pop0019, p20_pop0305, p20_pop0610, p20_pop1117, p20_pop1529, p20_pop1824, p20_pop2064, p20_pop2539, p20_pop3044, p20_pop4054, p20_pop4559, p20_pop5564, p20_pop6074, p20_pop6579, p20_pop65p, p20_pop75p, p20_pop80p, p20_pop_etr, p20_pop_fr, p20_pop_imm, p20_popf, p20_poph, typ_iris
    FROM public."iris_data_D2020";
